<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Lane Flip Sprint</title><style>body{margin:0;background:#000;color:#fff;font-family:system-ui,-apple-system,sans-serif}#wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;gap:10px}canvas{background:#111;touch-action:none;border-radius:12px}.row{display:flex;gap:8px}button{padding:10px 14px;border:none;border-radius:10px;background:#222;color:#fff}button:active{transform:scale(.98)}#hud{font-size:14px;opacity:.9}</style></head><body><div id="wrap"><div id="hud">Score: <span id="score">0</span> Â· Best: <span id="best">0</span></div><canvas id="game" width="360" height="640"></canvas><div class="row"><button id="restart">Restart</button> <button id="revive" disabled="disabled">Revive (Rewarded)</button></div></div><script>const bridge={send(e,t={}){window.parent?.postMessage({type:e,payload:t},"*")},on(e,t){window.addEventListener("message",n=>{n.data&&n.data.type===e&&t(n.data.payload||{})})}};bridge.on("INTERSTITIAL_CLOSED",()=>{}),bridge.on("REWARDED_GRANTED",e=>{"revive"===e.rewardType&&doRevive()}),bridge.on("REWARDED_DENIED",()=>{});const canvas=document.getElementById("game"),ctx=canvas.getContext("2d"),scoreEl=document.getElementById("score"),bestEl=document.getElementById("best"),restartBtn=document.getElementById("restart"),reviveBtn=document.getElementById("revive"),lanes=[.33*canvas.width,.67*canvas.width],player={lane:0,y:canvas.height-90,r:18},obstacles=[];let running=!1,score=0,best=Number(localStorage.getItem("best")||0),startMs=0,dead=!1,canRevive=!1,invincibleMs=0,spawnTimer=0,lastMs=0;function reset(){running=!0,dead=!1,canRevive=!1,reviveBtn.disabled=!0,score=0,scoreEl.textContent="0",obstacles.length=0,spawnTimer=0,invincibleMs=0,startMs=performance.now(),lastMs=performance.now(),bridge.send("GAME_START",{})}function gameOver(){if(dead)return;dead=!0,running=!1;const e=Math.max(0,performance.now()-startMs);bridge.send("GAME_OVER",{score:score,durationMs:e}),canRevive=!0,reviveBtn.disabled=!1,bridge.send("REQUEST_INTERSTITIAL",{reason:"game_over"}),score>best&&(best=score,localStorage.setItem("best",String(best)),bestEl.textContent=best)}function doRevive(){if(canRevive){canRevive=!1,reviveBtn.disabled=!0,running=!0,dead=!1,invincibleMs=1500;for(let e=obstacles.length-1;e>=0;e--)obstacles[e].y>player.y-120&&obstacles.splice(e,1)}}function spawnObstacle(){const e=Math.random()<.5?0:1;obstacles.push({lane:e,y:-30,w:80,h:26})}function update(e){if(!running)return;spawnTimer-=e,spawnTimer<=0&&(spawnTimer=.7,spawnObstacle());const t=220+6*score;for(let n=obstacles.length-1;n>=0;n--){const a=obstacles[n];if(a.y+=t*e,a.y-a.h/2>canvas.height+10)obstacles.splice(n,1),score+=1,scoreEl.textContent=String(score);else if(a.lane===player.lane&&invincibleMs<=0){Math.abs(a.y-player.y)<a.h/2+player.r&&gameOver()}}invincibleMs>0&&(invincibleMs-=1e3*e)}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#0b0b0b",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.strokeStyle="#222",ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(canvas.width/2,0),ctx.lineTo(canvas.width/2,canvas.height),ctx.stroke();for(const e of obstacles){ctx.fillStyle="#e74c3c";const t=lanes[e.lane]-e.w/2,n=e.y-e.h/2;ctx.fillRect(t,n,e.w,e.h)}ctx.fillStyle=invincibleMs>0?"#f1c40f":"#4aa3ff",ctx.beginPath(),ctx.arc(lanes[player.lane],player.y,player.r,0,2*Math.PI),ctx.fill(),dead&&(ctx.fillStyle="#fff",ctx.font="20px system-ui, sans-serif",ctx.fillText("Game Over",canvas.width/2-55,canvas.height/2),ctx.font="14px system-ui, sans-serif",ctx.fillText("Tap Restart or Revive",canvas.width/2-70,canvas.height/2+24))}function loop(e){const t=Math.min(.032,(e-lastMs)/1e3);lastMs=e,update(t),draw(),requestAnimationFrame(loop)}bestEl.textContent=best,reviveBtn.addEventListener("click",()=>{bridge.send("REQUEST_REWARDED",{reason:"revive"})}),restartBtn.addEventListener("click",()=>reset()),canvas.addEventListener("pointerdown",()=>{running&&(player.lane=1-player.lane)}),requestAnimationFrame(loop),reset()</script></body></html>